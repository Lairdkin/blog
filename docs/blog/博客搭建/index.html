<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="站点描述">
<title>
Hexo博客搭建 - 无名博客
</title>



        
        <meta property="og:title" content="Hexo博客搭建 - 无名博客" />
<meta property="og:type" content="website" />
<meta property="og:description" content="站点描述"/>
<meta property="og:url" content="https://radish.cloud/blog/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
<meta property="og:site_name" content="无名博客"/>




<meta property="og:image" content="https://radish.cloud/home/mx.jpg"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.20f701138a49cf7971fe80b1829416789fa588f156b3a6c8c1a09fa03d89a991.css" integrity="sha256-IPcBE4pJz3lx/oCxgpQWeJ&#43;liPFWs6bIwaCfoD2JqZE=" crossorigin="anonymous" media="screen">




    <link rel="stylesheet" href="/foo.css" integrity="" crossorigin="anonymous" media="screen">

        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero  fade-in one ">
                

<h1 class="bold-title is-1">博客</h1>


            </div>
            
            <div class="section  fade-in two ">
                
<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/">主页</a>
            

            
            

            
                
            

            
                
            

            
            
            
            
            
            <a class="navbar-item" href="/#about">关于我</a>
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://radish.cloud/projects/">
                  
                  
                  项目
                  
                  
                  </a>
                
                
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://radish.cloud/blog/">
                  
                  返回到-&gt; 博客
                  
                  </a>
                
                
            
            
            
            

            
            
            <a class="navbar-item" href="/#contact">联系我</a>
            
            

            
            
            
            
            <a class="navbar-item" href="https://radish.cloud/en/">English</a>
            
            

            
            <a class="navbar-item" href="https://radish.cloud/index.xml"><i class="fas fa-rss"></i></a>
            
            
        </div>
    </nav>
    <hr>
</div>



                
<div class="container">
    <h2 class="title is-1 top-pad strong-post-title">
        <a href="https://radish.cloud/blog/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">Hexo博客搭建</a>
    </h2>
    <div class="post-data">
        
        3 分钟
    </div>
    
    <div class="blog-share">
        分享:
        
        <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Hexo%e5%8d%9a%e5%ae%a2%e6%90%ad%e5%bb%ba%20https%3a%2f%2fradish.cloud%2fblog%2f%25E5%258D%259A%25E5%25AE%25A2%25E6%2590%25AD%25E5%25BB%25BA%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fab fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>
        
        
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fradish.cloud%2fblog%2f%25E5%258D%259A%25E5%25AE%25A2%25E6%2590%25AD%25E5%25BB%25BA%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fab fa-facebook-f"></i>
            <span class="hidden">Facebook</span>
        </a>
        
        
        <a class="icon-pinterest" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fradish.cloud%2fblog%2f%25E5%258D%259A%25E5%25AE%25A2%25E6%2590%25AD%25E5%25BB%25BA%2f&amp;description=Hexo%e5%8d%9a%e5%ae%a2%e6%90%ad%e5%bb%ba" onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
            <i class="fab fa-pinterest-p"></i>
            <span class="hidden">Pinterest</span>
        </a>
        
    </div>
    
    
      
    
      
    
      
    
      
      
     <p>
         Tags: 
          
           <a href="/tags/hexo">
             Hexo</a>,
         
           <a href="/tags/nodejs">
             nodejs</a>
         
        </p>
      
    
      
    
</div>

<div class="container markdown top-pad">
    <p>最近记性实在是下降的厉害，搞的东西天天忘，所以把咕了好几年的博客又捡起来了，这次选用了Hexo作为博客的引擎，支持markdown，轻量，部署简单，不过安装中还是踩了一些坑，简单的记录下（其实就是博客太空水一篇2333</p>
<!-- toc -->

<h2 id="环境" class="anchor-link"><a href="#%e7%8e%af%e5%a2%83">环境</a></h2>
<ul>
<li>
<p>服务器：阿里云学生机 轻量级应用服务器</p>
</li>
<li>
<p>服务器系统：Ubuntu16.04</p>
<p>阿里云一直不提供1804的镜像，但是不推荐手动升级，容易挂</p>
</li>
<li>
<p>本地系统：Manjaro 18.0 Illyria</p>
</li>
</ul>

<h2 id="部署" class="anchor-link"><a href="#%e9%83%a8%e7%bd%b2">部署</a></h2>
<p>Hexo生成的是纯静态页面，所以部署只需将hexo生成的public目录放置在 nginx 站点目录下就可以</p>

<h3 id="hexo-安装" class="anchor-link"><a href="#hexo-%e5%ae%89%e8%a3%85">Hexo 安装</a></h3>
<p>安装Hexo 前确保系统有以下软件：</p>
<ul>
<li>Node.js</li>
<li>Git</li>
</ul>
<p>因为Ubuntu源中提供的nodejs版本非常老，所以我们使用<img src="https://nodejs.org" alt="nodejs">官网提供的一个安装方式来安装nodejs</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span># Using Ubuntu
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">2</span>curl -sL https://deb.nodesource.com/setup_11.x | sudo -E bash -
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">3</span>sudo apt-get install -y nodejs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">5</span># Using Debian, as root
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">6</span>curl -sL https://deb.nodesource.com/setup_11.x | bash -
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">7</span>apt-get install -y nodejs
</code></pre></div><p>这个脚本会自动识别系统版本并添加ppa源</p>
<p>然后</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span><span style="color:#586e75"># 安装git</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">2</span>sudo apt install git
</code></pre></div><p>因为我们是在服务器端调用hexo生成静态页面，所以本地只需要安装git就可以</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span><span style="color:#586e75"># manjaro 安装git</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">2</span>sudo pacman -S git 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">3</span><span style="color:#586e75"># 也可以在本地安装nodejs，方便调试</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">4</span>sudo pacman -S nodejs
</code></pre></div><p>然后安装hexo</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span> npm install -g hexo-cli
</code></pre></div><p>测试一下</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>hexo -v
</code></pre></div><p>输出</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1</span>hexo-cli: 1.1.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2</span>os: Linux 4.19.1-1-MANJARO linux x64
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3</span>http_parser: 2.8.1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4</span>node: 11.1.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5</span>v8: 7.0.276.32-node.7
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6</span>uv: 1.23.2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7</span>zlib: 1.2.11
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8</span>ares: 1.15.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9</span>modules: <span style="color:#2aa198">67</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10</span>nghttp2: 1.34.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11</span>napi: <span style="color:#2aa198">3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12</span>openssl: 1.1.1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13</span>icu: 63.1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14</span>unicode: 11.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15</span>cldr: 34.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16</span>tz: 2018e
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17</span>
</code></pre></div><p>Hexo 安装完毕</p>

<h3 id="hexo新建站点和基本配置" class="anchor-link"><a href="#hexo%e6%96%b0%e5%bb%ba%e7%ab%99%e7%82%b9%e5%92%8c%e5%9f%ba%e6%9c%ac%e9%85%8d%e7%bd%ae">Hexo新建站点和基本配置</a></h3>
<p>选择一个存放站点文件的目录，执行</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>hexo init “站点名”
</code></pre></div><p>hexo会在当前目录下新建一个站点文件夹，cd进站点文件夹，执行</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>npm install
</code></pre></div><p>执行完成后，生成目录如下</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1</span>$ tree blog 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2</span>blog
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3</span>├── _config.yml
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4</span>├── db.json
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5</span>├── node_modules
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6</span>├── package.json
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7</span>├── package-lock.json
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8</span>├── scaffolds
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9</span>├── source
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10</span>└── themes
</code></pre></div><p>其中_config.yml是整个站点的配置文件，source是存放文章来源的md文件的，package.json存放了站点的依赖，theme是主题文件</p>
<p>在站点文件夹内，使用</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>hexo g
</code></pre></div><p>生成静态文件，静态文件存放在该目录的<code>public/</code>下</p>
<p>然后编辑_config.yml</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2</span><span style="color:#586e75"># 站点基本信息</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3</span><span style="color:#268bd2">title</span>:  <span style="color:#586e75">#站点名称</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4</span><span style="color:#268bd2">subtitle</span>:  <span style="color:#586e75">#子标题</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5</span><span style="color:#268bd2">description</span>: 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6</span><span style="color:#268bd2">keywords</span>: 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7</span><span style="color:#268bd2">author</span>: 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8</span><span style="color:#268bd2">language</span>: zh-cn <span style="color:#586e75">#语言设置为简体中文</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9</span><span style="color:#268bd2">timezone</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11</span><span style="color:#586e75"># 站点链接配置</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12</span><span style="color:#268bd2">url</span>: http://ljmx.top
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13</span><span style="color:#268bd2">root</span>: /
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14</span><span style="color:#268bd2">permalink</span>: :year/:month/:title.html
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15</span><span style="color:#268bd2">permalink_defaults</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17</span><span style="color:#586e75"># 一些默认文件的配置</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18</span><span style="color:#268bd2">source_dir</span>: source
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19</span><span style="color:#268bd2">public_dir</span>: public
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20</span><span style="color:#268bd2">tag_dir</span>: tags
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21</span><span style="color:#268bd2">archive_dir</span>: archives
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22</span><span style="color:#268bd2">category_dir</span>: categories
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23</span><span style="color:#268bd2">code_dir</span>: downloads/code
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24</span><span style="color:#268bd2">i18n_dir</span>: :lang
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">25</span><span style="color:#268bd2">skip_render</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">26</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">27</span><span style="color:#586e75"># 使用hexo new 时写作模板</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">28</span><span style="color:#586e75"># 因为平时都是直接新建md文件，所以这里一般都用不上QAQ</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">29</span><span style="color:#586e75"># </span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">30</span><span style="color:#268bd2">new_post_name</span>: :title.md <span style="color:#586e75"># File name of new posts</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">31</span><span style="color:#268bd2">default_layout</span>: post
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">32</span><span style="color:#268bd2">titlecase</span>: <span style="color:#cb4b16">false</span> <span style="color:#586e75"># Transform title into titlecase</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">33</span><span style="color:#268bd2">external_link</span>: <span style="color:#cb4b16">true</span> <span style="color:#586e75"># Open external links in new tab</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">34</span><span style="color:#268bd2">filename_case</span>: <span style="color:#2aa198">0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">35</span><span style="color:#268bd2">render_drafts</span>: <span style="color:#cb4b16">false</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">36</span><span style="color:#268bd2">post_asset_folder</span>: <span style="color:#cb4b16">false</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">37</span><span style="color:#268bd2">relative_link</span>: <span style="color:#cb4b16">false</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">38</span><span style="color:#268bd2">future</span>: <span style="color:#cb4b16">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">39</span><span style="color:#268bd2">highlight</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">40</span>  <span style="color:#268bd2">enable</span>: <span style="color:#cb4b16">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">41</span>  <span style="color:#268bd2">line_number</span>: <span style="color:#cb4b16">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">42</span>  <span style="color:#268bd2">auto_detect</span>: <span style="color:#cb4b16">false</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">43</span>  <span style="color:#268bd2">tab_replace</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">44</span>  
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">45</span><span style="color:#586e75"># 主页设定，这个一般根据主题来修改</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">46</span><span style="color:#268bd2">index_generator</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">47</span>  <span style="color:#268bd2">path</span>: <span style="color:#2aa198">&#39;&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">48</span>  <span style="color:#268bd2">per_page</span>: <span style="color:#2aa198">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">49</span>  <span style="color:#268bd2">order_by</span>: -date
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">50</span>  
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">51</span><span style="color:#586e75"># 标签</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">52</span><span style="color:#268bd2">default_category</span>: uncategorized
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">53</span><span style="color:#268bd2">category_map</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">54</span><span style="color:#268bd2">tag_map</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">55</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">56</span><span style="color:#586e75">#日期格式</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">57</span><span style="color:#268bd2">date_format</span>: YYYY-MM-DD
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">58</span><span style="color:#268bd2">time_format</span>: HH:mm:ss
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">59</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">60</span><span style="color:#586e75"># 分页</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">61</span><span style="color:#268bd2">per_page</span>: <span style="color:#2aa198">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">62</span><span style="color:#268bd2">pagination_dir</span>: page
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">63</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">64</span><span style="color:#586e75"># 拓展，主题和插件</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">65</span><span style="color:#586e75">## Plugins: https://hexo.io/plugins/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">66</span><span style="color:#586e75">## Themes: https://hexo.io/themes/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">67</span><span style="color:#268bd2">theme</span>: anatole
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">68</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">69</span><span style="color:#586e75"># Deployment</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">70</span><span style="color:#586e75">## Docs: https://hexo.io/docs/deployment.html</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">71</span><span style="color:#586e75"># 自动部署配置，没用过2333</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">72</span><span style="color:#268bd2">deploy</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">73</span>  <span style="color:#268bd2">type</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">74</span>
</code></pre></div><p>然后可以选择一个自己喜欢的主题，放到/theme 文件夹里，在配置文件theme行写上主题名称，生成文件即可更换主题</p>
<blockquote>
<p>我们使用的主题依赖 <code>hexo-render-pug</code>插件，所以启用前需要执行 <code>npm install hexo-render-pug --save</code>安装，才能正常渲染</p>
</blockquote>

<h3 id="nginx-配置" class="anchor-link"><a href="#nginx-%e9%85%8d%e7%bd%ae">Nginx 配置</a></h3>
<p>ubuntu1604 安装nginx</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>sudo apt install nginx
</code></pre></div><p>查看服务状态</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>service nginx status
</code></pre></div><p>Active状态显示 active证明配置正常</p>
<p>编辑<code>/etc/nginx/nginx.conf</code></p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span><span style="color:#586e75">#修改第一行，变更nginx执行权限，其实不推荐这样做，应该修改文件的访问权限，但是我懒233</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">2</span>user root
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">4</span><span style="color:#586e75">#增加一下一行到文件中</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">5</span>include /etc/nginx/conf.d/*.conf;
</code></pre></div><p>然后在<code>/etc/nginx/conf.d</code>目录中新建一个<code>站点名.conf</code>的文件，编辑这个文件</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">2</span>server <span style="color:#719e07">{</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">3</span>    listen 4000;         <span style="color:#586e75"># 监听端口</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">4</span>    server_name ljmx.top;    <span style="color:#586e75"># 站点域名</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">5</span>    root  /var/www/public;     <span style="color:#586e75"># 站点根目录,指向自己站点的public文件夹</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">6</span>    index index.html index.htm index.php;   <span style="color:#586e75"># 默认导航页</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">7</span><span style="color:#719e07">}</span>
</code></pre></div><p>重启nginx</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>service nginx restart
</code></pre></div>
<h3 id="webhook实现自动部署" class="anchor-link"><a href="#webhook%e5%ae%9e%e7%8e%b0%e8%87%aa%e5%8a%a8%e9%83%a8%e7%bd%b2">webhook实现自动部署</a></h3>
<p>现在博客部署好了，但是我每次写完文章，push到github，然后登录服务器，pull下来，执行生成语句，这样比较繁琐，所以我们的webhook就登场了</p>
<p>webhook是git上的一个服务，他提供了一种能力，当仓库发生变动时，webhook会自动post一段信息到预先设定的地址。通过这种方式，我们可以实现自动化生成和部署博客</p>
<p>在github项目主页中，点击<code>setting</code>&gt;<code>webhooks</code>，然后ADD一个新的webhook，Payload URL填写服务器ip+端口号+请求路径，请求类型选json，sceret随便生成，但是要记住。</p>
<p>在hexo站点根目录下新建一个叫webhook.js文件，
填入以下内容:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1</span><span style="color:#268bd2">var</span> http <span style="color:#719e07">=</span> require(<span style="color:#2aa198">&#39;http&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2</span><span style="color:#268bd2">var</span> createHandler <span style="color:#719e07">=</span> require(<span style="color:#2aa198">&#39;github-webhook-handler&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3</span><span style="color:#268bd2">var</span> handler <span style="color:#719e07">=</span> createHandler({ path<span style="color:#719e07">:</span> <span style="color:#2aa198">&#39;/webhooks_push&#39;</span>, secret<span style="color:#719e07">:</span> <span style="color:#2aa198">&#39;&#39;</span> })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4</span><span style="color:#586e75">// 上面的 secret 保持和 GitHub 后台设置的一致
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5</span><span style="color:#586e75"></span><span style="color:#268bd2">function</span> run_cmd(cmd, args, callback) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6</span>  <span style="color:#268bd2">var</span> spawn <span style="color:#719e07">=</span> require(<span style="color:#2aa198">&#39;child_process&#39;</span>).spawn;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7</span>  <span style="color:#268bd2">var</span> child <span style="color:#719e07">=</span> spawn(cmd, args);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8</span>  <span style="color:#268bd2">var</span> resp <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;&#34;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9</span>  child.stdout.on(<span style="color:#2aa198">&#39;data&#39;</span>, <span style="color:#268bd2">function</span>(buffer) { resp <span style="color:#719e07">+=</span> buffer.toString(); });
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10</span>  child.stdout.on(<span style="color:#2aa198">&#39;end&#39;</span>, <span style="color:#268bd2">function</span>() { callback (resp) });
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12</span>handler.on(<span style="color:#2aa198">&#39;error&#39;</span>, <span style="color:#268bd2">function</span> (err) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13</span>  console.error(<span style="color:#2aa198">&#39;Error:&#39;</span>, err.message)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15</span>handler.on(<span style="color:#2aa198">&#39;push&#39;</span>, <span style="color:#268bd2">function</span> (event) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16</span>  console.log(<span style="color:#2aa198">&#39;Received a push event for %s to %s&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17</span>    event.payload.repository.name,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18</span>    event.payload.ref);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19</span>    run_cmd(<span style="color:#2aa198">&#39;sh&#39;</span>, [<span style="color:#2aa198">&#39;./deploy.sh&#39;</span>], <span style="color:#268bd2">function</span>(text){ console.log(text) });
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21</span><span style="color:#719e07">try</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22</span>  http.createServer(<span style="color:#268bd2">function</span> (req, res) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23</span>    handler(req, res, <span style="color:#268bd2">function</span> (err) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24</span>      res.statusCode <span style="color:#719e07">=</span> <span style="color:#2aa198">404</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">25</span>      res.end(<span style="color:#2aa198">&#39;no such location&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">26</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">27</span>  }).listen(<span style="color:#2aa198">6000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">28</span>  <span style="color:#586e75">//可以在这修改监听端口号
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">29</span><span style="color:#586e75"></span>}<span style="color:#719e07">catch</span>(err){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">30</span>  console.error(<span style="color:#2aa198">&#39;Error:&#39;</span>, err.message)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">31</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">32</span>
</code></pre></div><p>在目录下新建一个deploy.sh的文件，填入以下内容</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span><span style="color:#586e75">#填入markdown文件所在位置</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">2</span><span style="color:#b58900">cd</span> /root/website/myblog/source
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">3</span>git reset --hard
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">4</span>git pull origin master  
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">5</span>hexo generate
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">6</span>
</code></pre></div><p>然后安装依赖：</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>npm install github-webhook-handler --save
</code></pre></div><p>运行</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">1</span>node webhook.js
</code></pre></div><p>可以使用pm2，或者nohup等方式守护进程</p>
<p>这样当提交pull request的时候，服务器就会自动生成静态文件并部署了</p>

<h2 id="其他" class="anchor-link"><a href="#%e5%85%b6%e4%bb%96">其他</a></h2>
<p>因为时间匆忙（其实就是懒，所以很多东西还没有完善，留给下篇博文吧</p>
<p>待完成</p>
<ul>
<li><input disabled="" type="checkbox"> 修改博客模板</li>
<li><input disabled="" type="checkbox"> 全站ssl</li>
<li><input disabled="" type="checkbox"> 访问统计</li>
<li><input disabled="" type="checkbox"> 资源文件夹</li>
<li><input disabled="" type="checkbox"> 多用户</li>
</ul>

</div>




<section class="comments">
<script src="https://utteranc.es/client.js"
        repo="Lairdkin/blog"
        issue-term="title"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
</section>



                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        <span class="footer-text">
            © 2017-2021 萝卜炖鱼丸 | 蒙ICP备14003205号-2 | <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh"><strong>CC BY-SA 4.0</strong></a> 许可</br> 站点部署于<a href="https://pages.github.com/"><strong>GIthub Pages</strong></a>，由<a href="cloudflare.com"><strong>Cloudflare</strong></a>提供加速</br> <a href="https://github.com/victoriadrake/hugo-theme-introduction/"><strong>Introduction</strong></a> 主题为 <a href="http://gohugo.io/">Hugo</a> 而设。由开源社群贡献者以 <a href="https://victoria.dev"><i class="fa fa-heart"></i> 和 <i class="fa fa-coffee"></i></a> 创造。
        </span>
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="https://radish.cloud/js/bundle.f6c977229f84ae8df89c8647befcf3a170b8157f180a3f0afa4620b19a336994.js" integrity=""></script>








        
        
        
        
    </body>
</html>
